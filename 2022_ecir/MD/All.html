<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Peter Flach Slides – all</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Peter Flach Slides</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" rel="" target="" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">2023</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2023_nightingale/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AI in the time of chatGPT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2023_munich/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The highs and lows of performance evaluation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">2022</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2022_leuven/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The highs and lows of performance evaluation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2022_monash/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The highs and lows of performance evaluation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#audience-participation" id="toc-audience-participation" class="nav-link" data-scroll-target="#audience-participation">Audience participation!</a></li>
  <li><a href="#more-audience-participation" id="toc-more-audience-participation" class="nav-link" data-scroll-target="#more-audience-participation">More audience participation!</a></li>
  <li><a href="#last-one-i-promise--" id="toc-last-one-i-promise--" class="nav-link" data-scroll-target="#last-one-i-promise--">Last one, I promise :-)</a></li>
  <li><a href="#f_1-score" id="toc-f_1-score" class="nav-link" data-scroll-target="#f_1-score"><span class="math inline">\(F_{1}\)</span>-score</a></li>
  <li><a href="#f_1-score-1" id="toc-f_1-score-1" class="nav-link" data-scroll-target="#f_1-score-1"><span class="math inline">\(F_1\)</span>-score</a></li>
  <li><a href="#f_beta-score" id="toc-f_beta-score" class="nav-link" data-scroll-target="#f_beta-score"><span class="math inline">\(F_{\beta}\)</span>-score</a></li>
  <li><a href="#refresher-scales-and-means" id="toc-refresher-scales-and-means" class="nav-link" data-scroll-target="#refresher-scales-and-means">Refresher: Scales and Means</a></li>
  <li><a href="#comparing-means" id="toc-comparing-means" class="nav-link" data-scroll-target="#comparing-means">Comparing means</a></li>
  <li><a href="#outline-of-the-talk" id="toc-outline-of-the-talk" class="nav-link" data-scroll-target="#outline-of-the-talk">Outline of the talk</a></li>
  </ul></li>
  <li><a href="#roc-plots-101" id="toc-roc-plots-101" class="nav-link" data-scroll-target="#roc-plots-101">ROC plots 101</a>
  <ul class="collapse">
  <li><a href="#why-roc-plots-are-great" id="toc-why-roc-plots-are-great" class="nav-link" data-scroll-target="#why-roc-plots-are-great">Why ROC plots are great</a></li>
  <li><a href="#linear-interpolation" id="toc-linear-interpolation" class="nav-link" data-scroll-target="#linear-interpolation">Linear interpolation</a></li>
  <li><a href="#area-under-roc-curve-auroc" id="toc-area-under-roc-curve-auroc" class="nav-link" data-scroll-target="#area-under-roc-curve-auroc">Area under ROC curve (AUROC)</a></li>
  <li><a href="#calibration" id="toc-calibration" class="nav-link" data-scroll-target="#calibration">Calibration</a></li>
  <li><a href="#from-roc-plots-to-pr-plots" id="toc-from-roc-plots-to-pr-plots" class="nav-link" data-scroll-target="#from-roc-plots-to-pr-plots">From ROC plots to PR plots</a></li>
  <li><a href="#why-pr-plots-arent-great" id="toc-why-pr-plots-arent-great" class="nav-link" data-scroll-target="#why-pr-plots-arent-great">Why PR plots aren’t great</a></li>
  <li><a href="#from-pr-plots-to-prgain-plots" id="toc-from-pr-plots-to-prgain-plots" class="nav-link" data-scroll-target="#from-pr-plots-to-prgain-plots">From PR plots to PR<strong>Gain</strong> plots</a></li>
  <li><a href="#why-prg-plots-are-great" id="toc-why-prg-plots-are-great" class="nav-link" data-scroll-target="#why-prg-plots-are-great">Why PRG plots are great</a></li>
  <li><a href="#how-did-we-do-it" id="toc-how-did-we-do-it" class="nav-link" data-scroll-target="#how-did-we-do-it">How did we do it?</a></li>
  <li><a href="#prg-can-rank-models-differently-from-pr" id="toc-prg-can-rank-models-differently-from-pr" class="nav-link" data-scroll-target="#prg-can-rank-models-differently-from-pr">PRG can rank models differently from PR</a></li>
  <li><a href="#calibrated-scores-from-prg-curves" id="toc-calibrated-scores-from-prg-curves" class="nav-link" data-scroll-target="#calibrated-scores-from-prg-curves">Calibrated scores from PRG curves</a></li>
  </ul></li>
  <li><a href="#work-in-progress-on-prg-curves" id="toc-work-in-progress-on-prg-curves" class="nav-link" data-scroll-target="#work-in-progress-on-prg-curves">Work <em>in progress</em> on PRG curves</a>
  <ul class="collapse">
  <li><a href="#weighted-roc-curves" id="toc-weighted-roc-curves" class="nav-link" data-scroll-target="#weighted-roc-curves">Weighted ROC curves</a></li>
  <li><a href="#instance-weights" id="toc-instance-weights" class="nav-link" data-scroll-target="#instance-weights">Instance weights</a></li>
  <li><a href="#non-destructive-truncation" id="toc-non-destructive-truncation" class="nav-link" data-scroll-target="#non-destructive-truncation">Non-destructive truncation</a></li>
  </ul></li>
  <li><a href="#more-sophisticated-measurement-models" id="toc-more-sophisticated-measurement-models" class="nav-link" data-scroll-target="#more-sophisticated-measurement-models">More sophisticated measurement models</a>
  <ul class="collapse">
  <li><a href="#latent-variable-models" id="toc-latent-variable-models" class="nav-link" data-scroll-target="#latent-variable-models">Latent variable models</a></li>
  <li><a href="#beta-irt" id="toc-beta-irt" class="nav-link" data-scroll-target="#beta-irt">Beta-IRT</a></li>
  <li><a href="#adaptive-testing" id="toc-adaptive-testing" class="nav-link" data-scroll-target="#adaptive-testing">Adaptive testing</a></li>
  <li><a href="#cat-results" id="toc-cat-results" class="nav-link" data-scroll-target="#cat-results">CAT results</a></li>
  <li><a href="#more-here" id="toc-more-here" class="nav-link" data-scroll-target="#more-here">More here</a></li>
  <li><a href="#measurement-and-causality" id="toc-measurement-and-causality" class="nav-link" data-scroll-target="#measurement-and-causality">Measurement and causality</a></li>
  </ul></li>
  <li><a href="#to-conclude" id="toc-to-conclude" class="nav-link" data-scroll-target="#to-conclude">To conclude</a>
  <ul class="collapse">
  <li><a href="#to-conclude-2" id="toc-to-conclude-2" class="nav-link" data-scroll-target="#to-conclude-2">To conclude (2)</a></li>
  <li><a href="#to-conclude-3" id="toc-to-conclude-3" class="nav-link" data-scroll-target="#to-conclude-3">To conclude (3)</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/perellonieto/slides_flach/edit/quarto/2022_ecir/MD/All.md" class="toc-action">Edit this page</a></p><p><a href="https://github.com/perellonieto/slides_flach/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>I’m primarily a machine learner, but also work in AI and data science.</p>
<p>I don’t know much about IR, but have thought long and hard about performance and calibration of ML classifiers.</p>
<p>I think some of these ideas extend to IR, but would be very interested to hear your feedback.</p>
<p>Disclaimer: I am not a statistician! <!-- .element: class="fragment" --></p>
<section id="audience-participation" class="level3">
<h3 class="anchored" data-anchor-id="audience-participation">Audience participation!</h3>
<p>Q1: Why is <span class="math inline">\(F_1\)</span> the <em>harmonic</em> mean of precision and recall?</p>
<ol type="1">
<li>It’s a choice, it could equally well have been an arithmetic or geometric mean. <!-- .element: class="fragment" --></li>
<li>It corresponds to averaging the mistakes a classifier makes. <!-- .element: class="fragment" --></li>
<li>Another reason. <!-- .element: class="fragment" --></li>
</ol>
</section>
<section id="more-audience-participation" class="level3">
<h3 class="anchored" data-anchor-id="more-audience-participation">More audience participation!</h3>
<p>Q2: When is <span class="math inline">\(F_1\)</span> preferred over accuracy-based measures (micro/macro-accuracy)?</p>
<ol type="1">
<li>When we have many more negatives than positives. <!-- .element: class="fragment" --></li>
<li>When true negatives don’t add value. <!-- .element: class="fragment" --></li>
<li>Another reason. <!-- .element: class="fragment" --></li>
</ol>
</section>
<section id="last-one-i-promise--" class="level3">
<h3 class="anchored" data-anchor-id="last-one-i-promise--">Last one, I promise :-)</h3>
<p>Q3: If we use <span class="math inline">\(F_{1/2}\)</span>, then…</p>
<ol type="1">
<li>Precision gets twice the weight of recall. <!-- .element: class="fragment" --></li>
<li>Precision gets four times the weight of recall. <!-- .element: class="fragment" --></li>
<li>Neither. <!-- .element: class="fragment" --></li>
</ol>
</section>
<section id="f_1-score" class="level3">
<h3 class="anchored" data-anchor-id="f_1-score"><span class="math inline">\(F_{1}\)</span>-score</h3>
<p>Common definition: <span class="math inline">\(F_1 = \frac{2prec\cdot rec}{prec+rec}\)</span>.</p>
<p>As harmonic mean: <span class="math inline">\(\frac{1}{F_1} = \left(\frac{1}{rec} + \frac{1}{prec}\right)/2\)</span>. <!-- .element: class="fragment" --></p>
<p>Peter’s preferred definition: <span class="math display">\[F_{1} = \frac{TP}{TP + {\color{red}{\frac{FN+FP}{2}}}} = \frac{2TP}{2TP + FN+FP}\]</span> <!-- .element: class="fragment" --></p>
</section>
<section id="f_1-score-1" class="level3">
<h3 class="anchored" data-anchor-id="f_1-score-1"><span class="math inline">\(F_1\)</span>-score</h3>
<p><span class="math inline">\(\frac{1}{F_1} = \left(\frac{1}{rec} + \frac{1}{prec}\right)/2\)</span></p>
<p><span class="math inline">\(F_{1} = \frac{2TP}{2TP + FN+FP}\)</span></p>
<p>Aka accuracy over a <em>modified</em> confusion matrix:</p>
<p><span class="math display">\[
\begin{array}{lccc}
\hline
           &amp; \text{Pred}\ + &amp; \text{Pred}\ - &amp;     \\\\ \hline
\text{Actual}\ + &amp; TP            &amp; FN            &amp; Pos \\\\
\text{Actual}\ - &amp; FP            &amp; {\color{red}{TP}}            &amp; Neg{\color{red}{-TN+TP}} \\\\
           &amp; \ldots          &amp; \ldots          &amp; \ldots  \\\\ \hline
\end{array}
\]</span></p>
</section>
<section id="f_beta-score" class="level3">
<h3 class="anchored" data-anchor-id="f_beta-score"><span class="math inline">\(F_{\beta}\)</span>-score</h3>
<p><span class="math inline">\(1/F_{\beta} = \frac{\beta^2}{\beta^2+1} 1/rec + \frac{1}{\beta^2+1} 1/prec\)</span></p>
<p><span class="math inline">\(F_{\beta} = \frac{(\beta^2+1) TP}{(\beta^2+1) TP + \beta^2 FN + FP}\)</span></p>
<p>Aka accuracy over a <em>modified</em> confusion matrix:</p>
<p><span class="math display">\[
\begin{array}{lccc}
\hline
           &amp; \text{Pred}\ + &amp; \text{Pred}\ - &amp;     \\\\ \hline
\text{Actual}\ + &amp; {\color{red}{\beta^2}} TP            &amp; {\color{red}{\beta^2}} FN            &amp; {\color{red}{\beta^2}} Pos \\\\
\text{Actual}\ - &amp; FP            &amp; {\color{red}{TP}}            &amp; Neg{\color{red}{-TN+TP}} \\\\
           &amp; \ldots          &amp; \ldots          &amp; \ldots  \\\\ \hline
\end{array}
\]</span></p>
</section>
<section id="refresher-scales-and-means" class="level3">
<h3 class="anchored" data-anchor-id="refresher-scales-and-means">Refresher: Scales and Means</h3>
<p>Most means <span class="math inline">\(M(x,y)\)</span> are <em>quasi-arithmetic</em>: there exists a <strong>change of scale</strong> <span class="math inline">\(g: \mathbb{R} \rightarrow \mathbb{R}\)</span> such that <span class="math inline">\(M(x,y) = g^{-1}(AM(g(x),g(y)))\)</span>.</p>
<table class="table">
<thead>
<tr class="header">
<th>Mean</th>
<th><span class="math inline">\(M(x,y)\)</span></th>
<th><span class="math inline">\(g(x)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Arithmetic</td>
<td><span class="math inline">\((x+y)/2\)</span></td>
<td><span class="math inline">\(x\)</span></td>
</tr>
<tr class="even">
<td>Harmonic</td>
<td><span class="math inline">\(2/(1/x+1/y)\)</span></td>
<td><span class="math inline">\(1/x\)</span></td>
</tr>
<tr class="odd">
<td>Geometric</td>
<td><span class="math inline">\(\sqrt{xy}\)</span></td>
<td><span class="math inline">\(\ln x\)</span></td>
</tr>
<tr class="even">
<td>Quadratic</td>
<td><span class="math inline">\(\sqrt{(x^2+y^2)/2}\)</span></td>
<td><span class="math inline">\(x^2\)</span></td>
</tr>
<tr class="odd">
<td>Generalised</td>
<td><span class="math inline">\(\sqrt[p]{(x^p+y^p)/2}\)</span></td>
<td><span class="math inline">\(x^p\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="comparing-means" class="level3">
<h3 class="anchored" data-anchor-id="comparing-means">Comparing means</h3>
<p><img src="img/means.png" class="img-fluid" alt="Isometrics plot"> <!-- .element height="60%" width="60%" --></p>
<p>Towards <code>max</code> (<code>min</code>) the mean emphasises large (small) values.</p>
</section>
<section id="outline-of-the-talk" class="level3">
<h3 class="anchored" data-anchor-id="outline-of-the-talk">Outline of the talk</h3>
<ol type="1">
<li><a href="#/2">Precision-recall curves considered harmful</a></li>
<li><a href="#/3">Work <em>in progress</em> on PRG curves</a></li>
<li><a href="#/3">More sophisticated measurement models</a></li>
</ol>
<hr>
</section>
</section>
<section id="roc-plots-101" class="level2">
<h2 class="anchored" data-anchor-id="roc-plots-101">ROC plots 101</h2>
<p><img src="img/PRG2-fig-ExROC.png" class="img-fluid" alt="Empirical ROC curve"> <!-- .element height="40%" width="40%" --> <img src="img/PRG2-fig-ROC1.png" class="img-fluid" alt="Parametric ROC curve"> <!-- .element height="40%" width="40%" --></p>
<p>Shows how true and false positive rate co-vary with decision threshold.</p>
<section id="why-roc-plots-are-great" class="level3">
<h3 class="anchored" data-anchor-id="why-roc-plots-are-great">Why ROC plots are great</h3>
<ul>
<li><strong>universal baselines</strong> - ascending diagonal gives expected performance of baseline (random) model.</li>
<li><strong>linear interpolation</strong> - points on connecting line segments achieve same performance under specific class trade-offs.</li>
<li><strong>Pareto front</strong> - linear interpolation gives ROC convex hull (ROCCH).</li>
<li><strong>area under curve</strong> - meaningful measure of ranking performance <em>and</em> expected accuracy.</li>
<li><strong>calibration</strong> - ROCCH segments can be converted into meaningful probabilities.</li>
</ul>
</section>
<section id="linear-interpolation" class="level3">
<h3 class="anchored" data-anchor-id="linear-interpolation">Linear interpolation</h3>
<p>Any point on a straight line between thresholds (or classifiers) A and B can be achieved by making a suitably biased random choice between them.</p>
<p>If that line has slope <span class="math inline">\(Neg/Pos\)</span> (or 1) then all points on the line achieve the same micro-accuracy (or macro-accuracy).</p>
<p>This can be generalised to other trade-offs between classes (e.g., misclassification costs).</p>
</section>
<section id="area-under-roc-curve-auroc" class="level3">
<h3 class="anchored" data-anchor-id="area-under-roc-curve-auroc">Area under ROC curve (AUROC)</h3>
<p>This estimates the probability that a randomly selected positive is <em>ranked</em> before a randomly selected negative.</p>
<p>It is also linearly related to expected <em>classification performance</em> if thresholds are set to make a particular proportion of positive predictions (pred pos <em>rate</em>).</p>
<p><span class="math display">\[\int_0^1 acc\ d\ rate = \pi(1-\pi)(2AUROC-1)+1/2\]</span></p>
<p><a href="https://www.jmlr.org/papers/v13/hernandez-orallo12a.html">Hernandez-Orallo, Flach, Ferri. JMLR 13(91), 2012.</a></p>
</section>
<section id="calibration" class="level3">
<h3 class="anchored" data-anchor-id="calibration">Calibration</h3>
<p>Slopes of ROCCH segments are empirical likelihood ratios associated with score intervals, and can be used to obtain calibrated probabilities (isotonic regression).</p>
<p>If a perfectly calibrated classifier assigns score <span class="math inline">\({\color{red}c}\)</span> to an instance, then the instance is on the decision boundary for <span class="math inline">\(acc_{\color{red}c} = 2{\color{red}c}\pi tpr + 2{\color{red}c}(1-\pi) fpr\)</span>.</p>
<p><a href="https://arxiv.org/abs/2112.10327">Song et al.&nbsp;Classifier Calibration: How to assess and improve predicted class probabilities: a survey. arXiv</a></p>
</section>
<section id="from-roc-plots-to-pr-plots" class="level3">
<h3 class="anchored" data-anchor-id="from-roc-plots-to-pr-plots">From ROC plots to PR plots</h3>
<p><img src="img/fig1-left.png" class="img-fluid" alt="ROC curve"> <!-- .element height="40%" width="40%" --> <img src="img/fig1-right.png" class="img-fluid" alt="PR curve"> <!-- .element height="40%" width="40%" --></p>
<p>There is a point-to-point correspondence between ROC space and PR space.</p>
</section>
<section id="why-pr-plots-arent-great" class="level3">
<h3 class="anchored" data-anchor-id="why-pr-plots-arent-great">Why PR plots aren’t great</h3>
<ul>
<li><strong>non-universal baselines</strong> - random performance gives horizontal line which depends on class distribution.</li>
<li><strong>non-linear interpolation</strong> - iso-<span class="math inline">\(F_{\beta}\)</span> lines are hyperbolic.</li>
<li><strong>Pareto front</strong> is well-defined but non-convex.</li>
<li><strong>uninterpretable area</strong> - because of incoherence of taking arithmetic mean of precision values <em>and</em> unachievable region.</li>
<li><strong>no calibration</strong>.</li>
</ul>
</section>
<section id="from-pr-plots-to-prgain-plots" class="level3">
<h3 class="anchored" data-anchor-id="from-pr-plots-to-prgain-plots">From PR plots to PR<strong>Gain</strong> plots</h3>
<p><img src="img/fig2-left.png" class="img-fluid" alt="PR curve"> <!-- .element height="40%" width="40%" --> <img src="img/fig2-right.png" class="img-fluid" alt="PRG curve"> <!-- .element height="40%" width="40%" --></p>
<p><a href="http://people.cs.bris.ac.uk/~flach/PRGcurves">Flach and Kull. Precision-recall-gain curves: PR analysis done right. NIPS 2015.</a></p>
</section>
<section id="why-prg-plots-are-great" class="level3">
<h3 class="anchored" data-anchor-id="why-prg-plots-are-great">Why PRG plots are great</h3>
<ul>
<li><strong>baseline</strong> - descending diagonal gives expected performance of <em>always-positive</em> classifier <br> (<span class="math inline">\(rec=1, prec=\pi, F_1=\frac{2\pi}{\pi+1}\)</span>).</li>
<li><strong>linear interpolation</strong> is restored.</li>
<li><strong>Pareto front</strong> is once again convex.</li>
<li><strong>interpretable area</strong> - AUPRG is related to expected <span class="math inline">\(F_1\)</span> when operating points are chosen in a particular way.</li>
<li><strong>calibration</strong> - scores can be converted into values of <span class="math inline">\(\beta\)</span> such that the instance is on the <span class="math inline">\(F_{\beta}\)</span> decision boundary.</li>
</ul>
</section>
<section id="how-did-we-do-it" class="level3">
<h3 class="anchored" data-anchor-id="how-did-we-do-it">How did we do it?</h3>
<ol type="1">
<li>Take reciprocals: <span class="math inline">\(prec = TP/(TP+FP) \rightarrow 1/prec = 1+FP/TP\)</span> <span class="math inline">\(rec = TP/(TP+FN) \rightarrow 1/rec = 1+FN/TP\)</span></li>
<li>Clip <span class="math inline">\([1,\infty]\)</span> to <span class="math inline">\([1,1/\pi]\)</span> to exlude overly small values of precision/recall. <!-- .element: class="fragment" --></li>
<li>Map <span class="math inline">\([1,1/\pi]\)</span> back to unit interval: <span class="math display">\[
\begin{align}
precG &amp;= \frac{prec-\pi}{(1-\pi)prec} = 1 - \frac{\pi}{1-\pi} FP/TP \\\\
recG  &amp;= \frac{rec-\pi}{(1-\pi)rec} = 1 - \frac{\pi}{1-\pi} FN/TP \\\\
\end{align}
\]</span> <!-- .element: class="fragment" --></li>
</ol>
</section>
<section id="prg-can-rank-models-differently-from-pr" class="level3">
<h3 class="anchored" data-anchor-id="prg-can-rank-models-differently-from-pr">PRG can rank models differently from PR</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/PRG.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">from ROC via PR to PRG</figcaption>
</figure>
</div>
<p>Solid line has higher AUROC and AUPRG but lower AUPR than dashed line.</p>
</section>
<section id="calibrated-scores-from-prg-curves" class="level3">
<h3 class="anchored" data-anchor-id="calibrated-scores-from-prg-curves">Calibrated scores from PRG curves</h3>
<p><img src="img/fig3-left.png" class="img-fluid" alt="ROC curve"> <!-- .element height="40%" width="40%" --> <img src="img/fig3-right.png" class="img-fluid" alt="PR curve"> <!-- .element height="40%" width="40%" --></p>
<p>Left: scores calibrated for <span class="math inline">\(acc_{c}\)</span>.</p>
<p>Right: scores calibrated for <span class="math inline">\(F_{\beta}\)</span>.</p>
<hr>
</section>
</section>
<section id="work-in-progress-on-prg-curves" class="level2">
<h2 class="anchored" data-anchor-id="work-in-progress-on-prg-curves">Work <em>in progress</em> on PRG curves</h2>
<p><span class="math inline">\(AUPRG = \frac{\pi}{1-\pi}\int \frac{tpr-fpr}{tpr^3}\ d\ tpr\)</span></p>
<p><img src="img/PRG2-fig-AUPRG2.png" class="img-fluid" alt="instance weights"> <!-- .element height="50%" width="50%" --></p>
<section id="weighted-roc-curves" class="level3">
<h3 class="anchored" data-anchor-id="weighted-roc-curves">Weighted ROC curves</h3>
<p><img src="img/PRG2-fig-scratchExwPRG-left.png" class="img-fluid" alt="ROC curve"> <!-- .element height="40%" width="40%" --> <img src="img/PRG2-fig-scratchExwPRG-right.png" class="img-fluid" alt="PR curve"> <!-- .element height="40%" width="40%" --></p>
<p><em>Instance weights</em> allow us to translate PRG curves back to weighted ROC curves with the same area.</p>
</section>
<section id="instance-weights" class="level3">
<h3 class="anchored" data-anchor-id="instance-weights">Instance weights</h3>
<p>Let <span class="math inline">\(r\)</span> and <span class="math inline">\(s\)</span> be the true positive rates that obtain when thresholding just before or just after a positive example, then its weight is <span class="math inline">\(\frac{\pi}{1-\pi}\frac{1}{rs}\)</span>.</p>
<p>Horizontal movement in ROC space corresponds to changes in precision which is influenced by both positives and negatives, but can nevertheless be precisely characterised in a similar way.</p>
</section>
<section id="non-destructive-truncation" class="level3">
<h3 class="anchored" data-anchor-id="non-destructive-truncation">Non-destructive truncation</h3>
<p>In the NIPS’15 paper we truncated the PR curve so that <span class="math inline">\(\pi\leq rec\leq 1\)</span>.</p>
<p>Before truncating we can pad the ranking at the front with <span class="math inline">\(\frac{\pi}{1-\pi}Pos\)</span> pseudo-instances, all labelled positive.</p>
<p>This gives rise to adjusted measures, e.g.&nbsp; <span class="math inline">\(rec'=\frac{(1-\pi)TP+\pi Pos}{Pos}\)</span> and <span class="math inline">\(recG'=\frac{TP}{(1-\pi)TP+\pi Pos}\)</span>.</p>
<hr>
</section>
</section>
<section id="more-sophisticated-measurement-models" class="level2">
<h2 class="anchored" data-anchor-id="more-sophisticated-measurement-models">More sophisticated measurement models</h2>
<ul>
<li>What you see is not what you want: estimating task difficulty and model ability</li>
<li>Understanding <em>why</em> performance differences occur</li>
</ul>
<section id="latent-variable-models" class="level3">
<h3 class="anchored" data-anchor-id="latent-variable-models">Latent variable models</h3>
<ul>
<li>Psychologists have long understood that people’s abilities (and the difficulty of a task) are <em>not directly observable</em> and need to be estimated.
<ul>
<li>Item-response theory, factor analysis</li>
</ul></li>
<li>We can adapt those models to machine learning, to estimate <strong>ability</strong> of classifiers as well as <strong>difficulty</strong> of instances and datasets.</li>
</ul>
</section>
<section id="beta-irt" class="level3">
<h3 class="anchored" data-anchor-id="beta-irt">Beta-IRT</h3>
<p><img src="img/BIRT.png" class="img-fluid" alt="Beta-IRT"> <!-- .element height="40%" width="40%" --> <img src="img/beta_ICC_discr_a2.png" class="img-fluid" alt="ICC"> <!-- .element height="44%" width="44%" --></p>
<p><span class="math inline">\(E[p_{ij}|\delta_j,a_j] = \frac{1}{1+\left(\frac{\delta_i}{\theta_j}\cdot\frac{1-\theta_j}{1-\delta_i} \right)^{a_j}}\)</span></p>
</section>
<section id="adaptive-testing" class="level3">
<h3 class="anchored" data-anchor-id="adaptive-testing">Adaptive testing</h3>
<p>Use a trained IRT model to evaluate a new classifier on a small number of datasets.</p>
<ol type="1">
<li>Start with initial guess of classifier ability.</li>
<li>Choose next dataset using an <em>item selection criterion</em>.</li>
<li>Evaluate classifier and update ability estimation.</li>
<li>Repeat until stopping criterion is achieved.</li>
</ol>
</section>
<section id="cat-results" class="level3">
<h3 class="anchored" data-anchor-id="cat-results">CAT results</h3>
<p><img src="img/CAT.png" class="img-fluid" alt="CAT"> <!-- .element height="80%" width="80%" --></p>
</section>
<section id="more-here" class="level3">
<h3 class="anchored" data-anchor-id="more-here">More here</h3>
<ul>
<li><a href="http://proceedings.mlr.press/v89/chen19b.html">Chen, Silva Filho, Prudencio, Diethe, Flach. <span class="math inline">\(\beta^3\)</span>-IRT: A New Item Response Model and its Applications. AISTATS 2019.</a></li>
<li><a href="https://www.turing.ac.uk/sites/default/files/2021-07/efficient_and_robust_paper.pdf">Song and Flach. Efficient and Robust Model Benchmarks with Item Response Theory and Adaptive Testing. IJ Interactive Multimedia &amp; AI 6(5), 2021.</a></li>
</ul>
</section>
<section id="measurement-and-causality" class="level3">
<h3 class="anchored" data-anchor-id="measurement-and-causality">Measurement and causality</h3>
<p>Ultimately, empirical ML needs to make <em>causal</em> statements:</p>
<blockquote class="blockquote">
<p>Algorithm A outperformed algorithm B <strong>because</strong> the classes were highly imbalanced.</p>
</blockquote>
<ul>
<li>I.e., if the classes were re-balanced (counterfactual intervention) the difference in performance would disappear. <!-- .element: class="fragment" -->
<ul>
<li>In empirical ML we usually can carry out interventions (aka ablation study). <!-- .element: class="fragment" --></li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="to-conclude" class="level2">
<h2 class="anchored" data-anchor-id="to-conclude">To conclude</h2>
<p>Perhaps surprisingly, a definitive account of key measurement concepts such as scales, units, and dimensions is still missing.</p>
<p><em>Stevens’ typology</em> (nominal, ordinal, interval, ratio) is well-known but limited: e.g., it doesn’t cover scales bounded from both sides (probabilities!).</p>
<p>In physics, quantities are understood to have an associated <em>dimension</em>, but these can cancel (angles, percentages) and don’t allow for transcendental functions (logs).</p>
<section id="to-conclude-2" class="level3">
<h3 class="anchored" data-anchor-id="to-conclude-2">To conclude (2)</h3>
<p>These issues notwithstanding, performance evaluation in ML and IR is often formulaic and simplistic.</p>
<p>Including every performance indicator you can think of may make the <strong>big table</strong> look impressive, but doesn’t necessarily exude confidence that you know what you’re doing.</p>
<p>Indicators such as accuracy (for classification), AUC (for ranking), Brier score (for probability estimation) should really be thought of as different ‘dimensions’ as in physics. What is your use case?</p>
</section>
<section id="to-conclude-3" class="level3">
<h3 class="anchored" data-anchor-id="to-conclude-3">To conclude (3)</h3>
<p>Proper treatment of performance evaluation in machine learning (and AI more generally) requires a sophisticated model with the following components: - <em>Measurement scales</em> for the observable performance indicators; - <em>Latent-variable models</em> for the unobservable performance indicators of interest; - <em>Causal models</em> to allow for counterfactual reasoning.</p>
</section>
<section id="acknowledgements" class="level3">
<h3 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h3>
<p>Part of this work was funded through a <a href="https://www.turing.ac.uk/research/research-projects/measurement-theory-data-science-and-ai">project with the Alan Turing Institute</a>.</p>
<p>Many thanks to Jose Hernandez-Orallo, Kacper Sokol, Meelis Kull, Tom Diethe, Yu Chen, Ricardo Prudencio, Telmo Filho, Miquel Perello-Nieto, Hao Song, Su Whan Baek, and many others. <!-- .element: class="fragment" --></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Peter Flach (University of Bristol)</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This website was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>